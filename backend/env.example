############################
# RAG Embedding（智谱）
############################
# 强烈建议不要把真实 Key 提交到 git
ZHIPU_API_KEY=replace_me

# embedding-3 支持：256/512/1024/2048（建议 1024 或 2048）
RAG_ZHIPU_EMBED_MODEL=embedding-3
RAG_ZHIPU_EMBED_DIM=1024
RAG_ZHIPU_EMBED_URL=https://open.bigmodel.cn/api/paas/v4/embeddings

# 选择 embedding 提供方：zhipu | openai | local
RAG_EMBED_PROVIDER=zhipu

############################
# RAG 检索/切分参数（可调参）
############################
# Markdown 切块（字符数）：博客场景建议 800~1400
RAG_CHUNK_SIZE=900
# Overlap（字符数）：建议 80~200
RAG_CHUNK_OVERLAP=120
# 是否递归索引 _posts 子目录（1/0）
RAG_POSTS_RECURSIVE=1
# 是否把“标题/标签/分类”注入每个 chunk 内容里（提升按标题/标签召回）
RAG_INCLUDE_TITLE_IN_CHUNKS=1

# 召回条数（最终给大模型的引用数量）
RAG_TOP_K=5
# 候选召回条数（先多取，再过滤/去重）
RAG_CANDIDATE_K=12
# 距离阈值（cosine distance，越小越相似；留空=不启用）
# 经验值：0.25~0.45（需要用 /api/ai/mascot/debug_retrieve 看分布再调）
RAG_MAX_DISTANCE=
# 同一篇文章最多选多少个 chunk（防止上下文被单篇文章“霸占”）
RAG_PER_POST_MAX=2
# 给大模型的总上下文最大字符数（避免 prompt 过长）
RAG_MAX_CONTEXT_CHARS=6000
# 单个 chunk 传给大模型的最大字符数（过长会稀释重点）
RAG_MAX_CHUNK_CHARS=1400

############################
# RAG 生成（DeepSeek）
############################
DEEPSEEK_API_KEY=replace_me
RAG_CHAT_PROVIDER=deepseek
RAG_CHAT_BASE_URL=https://api.deepseek.com
RAG_CHAT_MODEL=deepseek-chat

# 可选：覆盖系统提示词（不写则使用 backend/routes/rag_bot/prompt.py）
RAG_CHAT_SYSTEM_PROMPT=

############################
# 又拍云存储配置
############################
# 又拍云 Bucket 名称
UPYUN_BUCKET=your_bucket_name

# 又拍云操作员名称
UPYUN_OPERATOR=your_operator_name

# 又拍云操作员密码
UPYUN_PASSWORD=your_operator_password

# 又拍云 API 端点（可选，默认 v0.api.upyun.com）
# UPYUN_API_ENDPOINT=v0.api.upyun.com

# 协议（可选，默认 http）
# UPYUN_PROTOCOL=http

