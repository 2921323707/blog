---
title: 机器学习模型评估
date: 2026-01-15
tags:
  - 机器学习
  - Python
  - 数据科学
categories:
  - 教程
---

# 机器学习模型评估

模型评估是机器学习的关键环节，帮助我们了解模型的真实性能。

## 常用评估指标~

### 分类问题

```python
from sklearn.metrics import (
    accuracy_score, precision_score, 
    recall_score, f1_score, confusion_matrix
)

# 准确率
accuracy = accuracy_score(y_true, y_pred)

# 精确率
precision = precision_score(y_true, y_pred)

# 召回率
recall = recall_score(y_true, y_pred)

# F1分数
f1 = f1_score(y_true, y_pred)

# 混淆矩阵
cm = confusion_matrix(y_true, y_pred)
```

### 回归问题

```python
from sklearn.metrics import (
    mean_squared_error, mean_absolute_error, r2_score
)

# 均方误差
mse = mean_squared_error(y_true, y_pred)

# 平均绝对误差
mae = mean_absolute_error(y_true, y_pred)

# R²分数
r2 = r2_score(y_true, y_pred)
```

## 交叉验证

```python
from sklearn.model_selection import cross_val_score
from sklearn.ensemble import RandomForestClassifier

model = RandomForestClassifier()
scores = cross_val_score(model, X, y, cv=5)
print(f"平均准确率: {scores.mean():.2f}")
print(f"标准差: {scores.std():.2f}")
```

## 学习曲线

```python
from sklearn.model_selection import learning_curve
import matplotlib.pyplot as plt

train_sizes, train_scores, val_scores = learning_curve(
    model, X, y, cv=5
)

plt.plot(train_sizes, train_scores.mean(axis=1), label='训练集')
plt.plot(train_sizes, val_scores.mean(axis=1), label='验证集')
plt.legend()
plt.show()
```

## 总结

- **准确率**：整体正确率
- **精确率**：预测为正例中真正为正例的比例
- **召回率**：真正例中被正确预测的比例
- **交叉验证**：更可靠的性能评估
- **学习曲线**：诊断过拟合/欠拟合

选择合适的评估指标，全面了解模型性能！
