<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>博客文章编辑器 - 嘟嘟可的个人博客</title>

    <!-- GitHub 风格 UI 依赖 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer">

    <!-- Markdown 编辑器样式 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@5.2.0/github-markdown.min.css">

    <!-- 自定义样式 -->
    <link rel="stylesheet" href="/static/css/base.css">
    <link rel="stylesheet" href="/static/css/layout.css">
    <link rel="stylesheet" href="/static/css/form.css">
    <link rel="stylesheet" href="/static/css/list.css">
    <link rel="stylesheet" href="/static/css/modal.css">
    <link rel="stylesheet" href="/static/css/responsive.css">

    <!-- Markdown 解析库 -->
    <script src="https://cdn.jsdelivr.net/npm/marked@11.1.1/marked.min.js"></script>

</head>

<body>
    <!-- 顶部导航栏 -->
    <header class="admin-header">
        <div class="header-container">
            <div class="header-left">
                <h1 class="site-title">
                    <i class="fas fa-blog"></i>
                    <span>博客文章管理</span>
                </h1>
            </div>
            <div class="header-right">
                <button class="btn-icon" id="viewToggle" title="切换视图">
                    <i class="fas fa-list" id="viewToggleIcon"></i>
                    <span id="viewToggleText">文章列表</span>
                </button>
                <button class="btn-icon" id="importMdBtn" title="导入 Markdown 文件">
                    <i class="fas fa-file-import"></i>
                </button>
                <input type="file" id="importMdInput" accept=".md,.markdown" style="display: none;">
                <button class="btn-icon" id="themeToggle" title="切换主题">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- 主要内容区域 -->
    <main class="admin-main">
        <div class="admin-container">
            <!-- 导入提示 -->
            <div class="import-notice" id="importNotice" style="display: none;">
                <div class="notice-content">
                    <i class="fas fa-info-circle"></i>
                    <span id="importNoticeText"></span>
                </div>
            </div>

            <!-- 文章列表视图 -->
            <div id="postsListView" class="posts-list-view" style="display: none;">
                <div class="posts-list-header">
                    <h2>
                        <i class="fas fa-list"></i>
                        文章列表
                    </h2>
                    <button class="btn btn-primary" id="newPostBtn">
                        <i class="fas fa-plus"></i>
                        新建文章
                    </button>
                </div>
                <div class="posts-list-container" id="postsListContainer">
                    <div class="loading" id="postsListLoading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <span>加载中...</span>
                    </div>
                </div>
            </div>

            <!-- 编辑器视图 -->
            <form id="postForm" class="post-form" style="display: none;">
                <!-- 文章标题 -->
                <div class="form-group">
                    <label for="title" class="form-label">
                        <i class="fas fa-heading"></i>
                        文章标题 <span class="required">*</span>
                    </label>
                    <input type="text" id="title" name="title" class="form-input" required placeholder="请输入文章标题">
                </div>

                <!-- 发布日期 -->
                <div class="form-group">
                    <label for="date" class="form-label">
                        <i class="fas fa-calendar"></i>
                        发布日期
                    </label>
                    <input type="date" id="date" name="date" class="form-input">
                    <div class="form-help">留空则使用当前日期</div>
                </div>

                <!-- 标签 -->
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-tags"></i>
                        标签
                    </label>
                    <div class="tags-wrapper">
                        <input type="text" class="tag-input form-input" id="tagInput" placeholder="输入标签后按回车添加">
                    </div>
                    <div id="tagsContainer" class="tags-container"></div>
                </div>

                <!-- 分类 -->
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-folder"></i>
                        分类
                    </label>
                    <div class="tags-wrapper">
                        <input type="text" class="category-input form-input" id="categoryInput"
                            placeholder="输入分类后按回车添加">
                    </div>
                    <div id="categoriesContainer" class="tags-container"></div>
                </div>

                <!-- 封面图片 -->
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-image"></i>
                        封面图片
                    </label>
                    <div class="upload-area cover-upload-area" id="coverUploadArea">
                        <div class="upload-content">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>点击或拖拽封面图片到这里上传</p>
                            <span class="upload-hint">支持 JPG、PNG、GIF、WebP 格式</span>
                        </div>
                        <input type="file" id="coverFileInput" accept="image/*" style="display: none;">
                    </div>
                    <div class="cover-preview" id="coverPreview"></div>
                    <div class="form-help">上传封面图片后，文章列表和详情页将显示此封面（可选）</div>
                </div>

                <!-- 图片上传 -->
                <div class="form-group">
                    <label class="form-label">
                        <i class="fas fa-images"></i>
                        图片上传
                    </label>
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-content">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>点击或拖拽图片到这里上传</p>
                            <span class="upload-hint">支持多张图片，支持 JPG、PNG、GIF、WebP 格式</span>
                        </div>
                        <input type="file" id="fileInput" multiple accept="image/*" style="display: none;">
                    </div>
                    <div class="image-preview" id="imagePreview"></div>
                    <div class="form-help">上传的图片会自动插入到文章末尾，您可以在编辑器中移动位置</div>
                </div>

                <!-- 文章内容 -->
                <div class="form-group">
                    <label for="content" class="form-label">
                        <i class="fas fa-file-alt"></i>
                        文章内容 (Markdown) <span class="required">*</span>
                    </label>
                    <div class="editor-wrapper">
                        <textarea id="content" name="content" class="form-textarea" required
                            placeholder="使用 Markdown 格式编写文章内容...&#10;&#10;支持语法：&#10;- 标题: # 一级标题&#10;- 列表: - 项目&#10;- 链接: [文本](URL)&#10;- 图片: ![描述](/img/图片名.jpg)&#10;- 代码: `代码` 或 ```代码块```"></textarea>
                        <div class="editor-toolbar">
                            <button type="button" class="toolbar-btn" data-action="preview" title="预览">
                                <i class="fas fa-eye"></i> 预览
                            </button>
                            <button type="button" class="toolbar-btn" data-action="help" title="Markdown 帮助">
                                <i class="fas fa-question-circle"></i> 帮助
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 操作按钮 -->
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary" id="submitBtn">
                        <i class="fas fa-paper-plane"></i>
                        <span id="submitBtnText">提交文章</span>
                    </button>
                    <button type="button" class="btn btn-secondary" id="previewBtn">
                        <i class="fas fa-eye"></i>
                        预览文章
                    </button>
                    <button type="button" class="btn btn-secondary" id="cancelEditBtn" style="display: none;">
                        <i class="fas fa-times"></i>
                        取消编辑
                    </button>
                </div>

                <!-- 状态提示 -->
                <div class="status" id="status"></div>
            </form>
        </div>
    </main>

    <!-- 预览模态框 -->
    <div id="previewModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <i class="fas fa-eye"></i>
                    文章预览
                </h2>
                <button class="modal-close" id="closePreview" title="关闭">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="previewContent" class="markdown-body"></div>
            </div>
        </div>
    </div>

    <!-- Markdown 帮助模态框 -->
    <div id="helpModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>
                    <i class="fas fa-question-circle"></i>
                    Markdown 语法帮助
                </h2>
                <button class="modal-close" id="closeHelp" title="关闭">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="markdown-body">
                    <h3>标题</h3>
                    <pre><code># 一级标题
## 二级标题
### 三级标题</code></pre>

                    <h3>列表</h3>
                    <pre><code>- 无序列表项
1. 有序列表项</code></pre>

                    <h3>链接和图片</h3>
                    <pre><code>[链接文本](https://example.com)
![图片描述](/img/image.jpg)</code></pre>

                    <h3>代码</h3>
                    <pre><code>`行内代码`
```代码块```</code></pre>

                    <h3>粗体和斜体</h3>
                    <pre><code>**粗体**
*斜体*</code></pre>

                    <h3>引用</h3>
                    <pre><code>&gt; 引用内容</code></pre>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript 模块 -->
    <script src="/static/js/config.js"></script>
    <script src="/static/js/utils.js"></script>
    <script src="/static/js/theme.js"></script>
    <script src="/static/js/tags.js"></script>
    <script src="/static/js/upload.js"></script>
    <script src="/static/js/form.js"></script>
    <script src="/static/js/list.js"></script>
    <script src="/static/js/editor.js"></script>
    <script src="/static/js/main.js"></script>
</body>

</html>